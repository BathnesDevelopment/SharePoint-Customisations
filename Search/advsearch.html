<!DOCTYPE html>
<html>
<title>Test sharepoint form</title>

<script src="//code.jquery.com/jquery-1.10.2.js"></script>
<script src="//code.jquery.com/ui/1.11.3/jquery-ui.js"></script>
<script src="//maxcdn.bootstrapcdn.com/bootstrap/3.3.2/js/bootstrap.min.js"></script>
<link rel="stylesheet" href="//code.jquery.com/ui/1.11.3/themes/smoothness/jquery-ui.css">
<link href="//maxcdn.bootstrapcdn.com/bootstrap/3.3.2/css/bootstrap.min.css" rel="stylesheet">
<script>
window.SETTINGS = {};

/*
* list of document labels
* From an export of the Term Store
*/
window.SETTINGS.Labels = {};
window.SETTINGS.Labels.Revs = ["Alternative Offer",
    "AOE Ceased Customer",
    "Attachment of Earnings Customer",
    "Attachment of Earnings Employer",
    "Bankruptcy Stage one",
    "Bankruptcy stat demand service",
    "Blank Letter Template",
    "Cancellationof IS/JSA deds (not in payt)",
    "Condolence Letter",
    "Correspondence Re Decd Persons",
    "Costs Letter",
    "Council Tax Executors/Solicitors Letter",
    "Council Tax Investigation Closure",
    "Council Tax Planning/Building Control",
    "Council Tax Proof of Debt",
    "CTax form enclosure letter",
    "Ctax Investigation Progress Report",
    "Customer bankruptcy advice",
    "Deductions from IS/JSA /ESA not required",
    "Deductions from IS/JSA/ESA",
    "Deductions from Pension Credit",
    "Deductions from pension credit not req",
    "Deductions from Pension Credits",
    "Exors Arrears Letter (Int)",
    "Failure to maintain pyt arrangment",
    "Forwarding Address Request",
    "HMO letter",
    "Instalment notification",
    "Joint Credit",
    "Last Day Liability",
    "Liability Query",
    "Miscellaneous Council Tax Letter",
    "Notice of Impending Committal (Int)",
    "Notice of Intended Enforcement Action",
    "R Bailiff Documents (New)",
    "R Bankruptcy docs",
    "R Charging Order docs",
    "R Court Documents (New)",
    "R Further Information Docs (New)",
    "R Miscellaneous Docs (New)",
    "Recovery Financial Means Enquiry Letter",
    "Severely mentally impaired outgoing",
    "Show Cause Letter",
    "Student Certificate Request"];
window.SETTINGS.Labels.Bens = ["A 2 Week Rem",
    "A 3 Mnth Visit 2nd Appointment",
    "A 3 Mnth Visit Appointment",
    "Appeal Tribunal Papers",
    "Appeals enclosure letter",
    "Appeals Service correspondence",
    "Authority to pay Landlord Direct",
    "Backdate refusal",
    "Benefit Acknowledgement letter",
    "Benefit Backdating request",
    "Benefit Change in Circumstances",
    "Benefit suspended awaiting info",
    "Benefits Appeal",
    "Benefits Application Form",
    "Benefits Bedroom Tax Appeal",
    "Benefits change in circumstances form",
    "Benefits change of address",
    "Benefits DHP Request",
    "Benefits incoming letter",
    "Benefits Initial Claim Form",
    "Benefits Investigation Closure",
    "Benefits Visit Appointment Letter",
    "Certificate of Earnings",
    "Compliance Statement",
    "Compliance Visit Letter 1",
    "County Court Action",
    "Date of first contact telephone memo",
    "DHP Decision Allowed",
    "DHP Refused",
    "Do not qualify letter",
    "DWP 3rd party deductions letter",
    "Evidence - general",
    "Evidence of capital",
    "Evidence of Earnings",
    "Evidence of rent",
    "Evidence of Unearned Income",
    "Further information request letter",
    "HB claim form enclosure letter",
    "HB Overpayment letter",
    "HB Student Calculation",
    "Housing Benefit DHP request outgoing",
    "In Person change of address",
    "In Person Change of Circs",
    "In Person Claim Form",
    "Income Visit Statement - benefits",
    "Investigation Progress Report",
    "IWKECL- In ? Out of Work evidence check",
    "IWKLDF- In ? Out of Work Landlord dec",
    "LHA Eight Week Arrears Proforma",
    "Local Authority Input Document",
    "New Claims Visited After 3 Mnths",
    "OP recovery from another LA",
    "Overpaid Council Tax Support",
    "Overpayment - Recovery Review",
    "Postal Review",
    "Postal review reminder/suspension",
    "Redetermination decision",
    "Request for Directions",
    "Request for reconsideration",
    "Response to Enquiry blank letter",
    "Revision/Supercession Decision",
    "Sanction appendix D",
    "Sanction appendix E",
    "Self Employed Calculation sheet",
    "Self Employed form and notes",
    "Self Employed Initial Income Form",
    "Unable to refer rent increase",
    "Valuation of Interest in Property",
    "Valuation shared interest in a property",
    "Young Persons Birthday enquiry",
    "Your sad loss"];
window.SETTINGS.Labels.NNDR = ["BANES completion notice",
    "BID Document",
    "Blank letter template",
    "Corresp Passed to VO",
    "Deferral Scheme Application form",
    "Disc Relief Application Refused",
    "Discretionary Rate Relief Application",
    "Discretionary Relief Allowed",
    "Discretionary Relief Review",
    "Exemption Request",
    "Hardship Relief Application",
    "Info Required from Leaving Ratepayer",
    "Insolvency Information",
    "Mandatory Rate Relief Application",
    "Maps/Plans",
    "Miscellaneous Letter",
    "ND Substituted Service Letter",
    "NDR Credit to former ratepayer",
    "NDR Planning/Building Control",
    "NNDR Enquiry Form",
    "NNDR Payment Confirmation",
    "Overpayment Calculation",
    "R Comm Court docs",
    "R N Financial Means Enquiry Form",
    "Rating Change Letter",
    "Recovery NNDR Alternative offer",
    "Recovery NNDR Banckruptcy Stage 1",
    "Recovery NNDR Committal notice",
    "Recovery NNDR Costs Letter",
    "Recovery NNDR Failure to maintain pyt ar",
    "Recovery NNDR Financial Means Enquiry",
    "Recovery NNDR Shew Cause Letter",
    "Recovery Notice of intended bailiff act",
    "Retail Rate Relief Incoming form",
    "Returned Request For Information",
    "Section 44(a) Certificate",
    "Section 44A Application",
    "Section 44A Certificate",
    "Small Business Rate Relief Application",
    "Small Business Rate Relief Letter",
    "Tax Certificate",
    "Valuation Officer Correspondence",
    "Visiting NNDR void"];
jQuery(function($){
    populateLabels();
    $("#fArea").change(function () {populateLabels();}); // Sharepoint strips js, so this is here instead of in the HTML
    $.datepicker.regional['en-GB'] = {
        closeText: 'Done',
        prevText: 'Prev',
        nextText: 'Next',
        currentText: 'Today',
        monthNames: ['January','February','March','April','May','June',
        'July','August','September','October','November','December'],
        monthNamesShort: ['Jan', 'Feb', 'Mar', 'Apr', 'May', 'Jun',
        'Jul', 'Aug', 'Sep', 'Oct', 'Nov', 'Dec'],
        dayNames: ['Sunday', 'Monday', 'Tuesday', 'Wednesday', 'Thursday', 'Friday', 'Saturday'],
        dayNamesShort: ['Sun', 'Mon', 'Tue', 'Wed', 'Thu', 'Fri', 'Sat'],
        dayNamesMin: ['Su','Mo','Tu','We','Th','Fr','Sa'],
        weekHeader: 'Wk',
        dateFormat: 'dd/mm/yy',
        firstDay: 1,
        isRTL: false,
        showMonthAfterYear: false,
        yearSuffix: ''};
    $.datepicker.setDefaults($.datepicker.regional['en-GB']);
});
$(function() {
    $('#from').datepicker({
        onClose: function ( dateText ) {
            SETTINGS.from = dateText;
        }
    });
    $('#to').datepicker({
        onClose: function ( dateText ) {
            SETTINGS.to = dateText;
        }
    });
    $('#search').click(search);
});
var search = function() {
    window.location.href = getURL() + getQuery();
};
var populateLabels = function() {
    // Populates the "Document Label" field with each document label
    var funcArea = $('#fArea').val();
    $("#docLabel").empty();
    $("#docLabel").append($("<option></option>").attr("value", "All").text("All"));
    var i = 0;
    if (funcArea === "All" || funcArea === "Revenues") {
        i = 0;
        for (i = 0; i < window.SETTINGS.Labels.Revs.length; i++ ) {
            $("#docLabel").append($("<option></option>").attr("value", window.SETTINGS.Labels.Revs[i]).text(window.SETTINGS.Labels.Revs[i]));
        }
    }
    if (funcArea === "All" || funcArea === "Benefits") {
        i = 0;
        for (i = 0; i < window.SETTINGS.Labels.Bens.length; i++ ) {
            $("#docLabel").append($("<option></option>").attr("value", window.SETTINGS.Labels.Bens[i]).text(window.SETTINGS.Labels.Bens[i]));
        }
    }
    if (funcArea === "All" || funcArea === "NNDR") {
        i = 0;
        for (i = 0; i < window.SETTINGS.Labels.NNDR.length; i++ ) {
            $("#docLabel").append($("<option></option>").attr("value", window.SETTINGS.Labels.NNDR[i]).text(window.SETTINGS.Labels.NNDR[i]));
        }
    }
};

var getURL = function() {
    res = "";

    var funcArea = $('#fArea').val();

    if (funcArea === "All") {
       res = "http://rbdoc/Search/Pages/results.aspx";
    } else if (funcArea === "Revenues") {
       res = "http://rbdoc/Search/Pages/Revenues.aspx";
    } else if (funcArea === "Benefits") {
        res = "http://rbdoc/Search/Pages/Benefits.aspx";
    } else if (funcArea === "NNDR" ) {
        res = "http://rbdoc/Search/Pages/NNDR.aspx";
    }

    return res + "?#k=";
};
var getQuery = function() {

    var res = "";
    SETTINGS.all = $('#all').val();
    SETTINGS.exact = $('#exact').val();
    SETTINGS.any = $('#any').val();
    SETTINGS.none = $('#none').val();
    SETTINGS.modifiedBy = $('#modifiedBy').val();
    SETTINGS.ref = $('#ref').val();
    SETTINGS.from = $('#from').val();
    SETTINGS.to = $('#to').val();
    SETTINGS.label = $('#docLabel').val();

    var addSpace = function() {
        if ("" !== res) {
            res += " ";
        }
    };
    if (SETTINGS.ref) {
        addSpace();
        res += "Ref:" + SETTINGS.ref;
        if (!$("#exactRef").is(':checked')) {
            res += "*";
        }
    }
    if (SETTINGS.all) {
        addSpace();
        res += "ALL(" + SETTINGS.all + ")";
    }
    if (SETTINGS.exact) {
        addSpace();
        res += "\"" + SETTINGS.exact + "\"";
    }
    if (SETTINGS.any) {
        addSpace();
        res += "ANY(" + SETTINGS.any + ")";
    }
    if (SETTINGS.none) {
        addSpace();
        res += "NONE(" + SETTINGS.none + ")";
    }
    if (SETTINGS.from && SETTINGS.to) {
        addSpace();
        res += "Modified:"+ SETTINGS.from + ".." + SETTINGS.to;
    }
    if (SETTINGS.modifiedBy) {
        addSpace();
        res += "ModifiedBy:\"" + SETTINGS.modifiedBy;
        if (!$("#exactMod").is(':checked')) {
            res += "*";
        }
        res += "\"";
    }
    if (SETTINGS.label && SETTINGS.label !== "All") {
         addSpace();
         res += "Label:\"" + SETTINGS.label + "\"";
    }
    return res;
};
</script>
</head>
<body>
    <h3>Show documents containing</h3>
    <div class="form-horizontal" role="form">
        <div class="form-group">
            <label class="control-label col-sm-2" for="all">All of these words</label>
            <div class="col-sm-8"><input type ="text" class="form-control" id = "all"></div>
        </div>
        <div class="form-group">
            <label class="control-label col-sm-2" for="exact">The exact phrase</label>
            <div class="col-sm-8"><input type ="text" class="form-control"  id = "exact"></div>
        </div>
        <div class="form-group">
            <label class="control-label col-sm-2" for="any">Any of these words</label>
            <div class="col-sm-8"><input type ="text" class="form-control"  id = "any"></div>
        </div>
        <div class="form-group">
            <label class="control-label col-sm-2" for="none">None of these words</label>
            <div class="col-sm-8"><input type ="text" class="form-control"  id = "none"></div>
        </div>
        <h3>Where</h3>
        <div class="form-group">
            <label class="control-label col-sm-2" for="ref">Reference</label>
            <div class="col-sm-7"><input type ="text" class="form-control" id = "ref"></div>
            <label class="col-sm-1">
                <input type="checkbox" id="exactRef"> Exact
            </label>
        </div>
        <div class="form-group">
            <label class="control-label col-sm-2" for="from">Modified date</label>
            <div class="col-sm-4"><input type ="text" class="form-control"  placeholder="Start - DD/MM/YYYY" id = "from"></div>
            <div class="col-sm-4"><input type ="text" class="form-control"  placeholder="End - DD/MM/YYYY" id = "to"></div>
        </div>
        <div class="form-group">
            <label class="control-label col-sm-2" for="modifiedBy">Author</label>
            <div class="col-sm-7"><input type ="text" class="form-control" id = "modifiedBy"></div>
            <label class="col-sm-1">
                <input type="checkbox" id="exactMod"> Exact
            </label>
        </div>
        <div class="form-group">
            <label class="control-label col-sm-2" for="from">Functional Area</label>
            <div class="col-sm-8"><select class="form-control " id="fArea">
                <option>All</option>
                <option>Revenues</option>
                <option>Benefits</option>
                <option>NNDR</option>
            </select></div>
        </div>
        <div class="form-group">
            <label class="control-label col-sm-2" for ="label">Document Label</label>
            <div class="col-sm-8"><select class="form-control " id="docLabel">
                <option>All</option>
            </select></div>
        </div>
        <a class="btn btn-default" id="search">Search</a>
    </div>
</body></html>